"use strict";(self.webpackChunkconnections_app=self.webpackChunkconnections_app||[]).push([[593],{5593:(E,v,n)=>{n.r(v),n.d(v,{MainComponent:()=>D});var C=n(6385),Z=n(617),g=n(6814),m=n(5665),u=n(2296),r=n(7700),p=n(6223),T=n(2032),f=n(5683),t=n(9212);let b=(()=>{class e{constructor(o,i){this.dialogRef=o,this.data=i}onNoClick(){this.dialogRef.close()}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(r.so),t.Y36(r.WI))};static#o=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-modal"]],standalone:!0,features:[t.jDz],decls:12,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(i,s){1&i&&(t.TgZ(0,"h1",0),t._uU(1,"add new group"),t.qZA(),t.TgZ(2,"div",1)(3,"mat-form-field")(4,"mat-label"),t._uU(5,"Name of your new group"),t.qZA(),t.TgZ(6,"input",2),t.NdJ("ngModelChange",function(c){return s.data.name=c}),t.qZA()()(),t.TgZ(7,"div",3)(8,"button",4),t.NdJ("click",function(){return s.onNoClick()}),t._uU(9,"cancel"),t.qZA(),t.TgZ(10,"button",5),t._uU(11,"create group"),t.qZA()()),2&i&&(t.xp6(6),t.Q6J("ngModel",s.data.name),t.xp6(4),t.Q6J("mat-dialog-close",s.data.name))},dependencies:[f.lN,f.KE,f.hX,T.c,T.Nt,p.u5,p.Fj,p.JJ,p.On,u.ot,u.lW,r.Is,r.ZT,r.uh,r.xY,r.H8]})}return e})();var x=n(5959),M=n(7398),d=n(5496),h=n(7378),A=n(2171),U=n(4423),I=n(3923),y=n(805),S=n(2572),F=n(9080),J=n(9360),N=n(8251);let G=(()=>{class e{constructor(){}startTimer(){this.timer$=(0,F.H)(0,1e3).pipe((0,M.U)(o=>60-o),function Y(e,l=!1){return(0,J.e)((o,i)=>{let s=0;o.subscribe((0,N.x)(i,a=>{const c=e(a,s++);(c||l)&&i.next(a),!c&&i.complete()}))})}(o=>o>=0))}getTimer(){return this.timer$}static#t=this.\u0275fac=function(i){return new(i||e)};static#o=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var L=n(5533),O=n(4221);function P(e,l){if(1&e&&(t.TgZ(0,"div",9),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.hij("timer:",o.timer,"")}}function j(e,l){if(1&e){const o=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(s){t.CHM(o);const a=t.oxw().$implicit,c=t.oxw();return t.KtG(c.deleteGroup(a.id.S,s))}),t.TgZ(1,"mat-icon"),t._uU(2," delete "),t.qZA()()}}function R(e,l){if(1&e){const o=t.EpF();t.TgZ(0,"mat-list-item",10),t.NdJ("click",function(){const a=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.selectGroupChat(a.id.S))}),t.TgZ(1,"mat-icon",11),t._uU(2,"forum"),t.qZA(),t.TgZ(3,"div",12),t._uU(4),t.YNc(5,j,3,0,"button",13),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"div",14),t._uU(8),t.ALo(9,"date"),t.qZA()()}if(2&e){const o=l.$implicit,i=t.oxw();t.xp6(4),t.hij(" ",o.name.S," "),t.xp6(1),t.um2(5,t.lcZ(6,3,i.userID$)===o.createdBy.S?5:-1),t.xp6(3),t.Oqu(t.lcZ(9,5,o.createdAt.S))}}function W(e,l){1&e&&t._UZ(0,"mat-icon",18)}function z(e,l){if(1&e){const o=t.EpF();t.TgZ(0,"mat-list-item",10),t.NdJ("click",function(){const a=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.selectUserForChat(a.conversationId,a.uid))}),t.TgZ(1,"mat-icon",16),t._uU(2,"people"),t.qZA(),t.TgZ(3,"div",12),t._uU(4),t.YNc(5,W,1,0,"mat-icon",17),t.qZA()()}if(2&e){const o=l.$implicit;t.xp6(4),t.hij(" ",o.name," "),t.xp6(1),t.um2(5,o.conversationId?5:-1)}}let D=(()=>{class e{constructor(o,i,s,a,c){this.dialog=o,this.timerService=i,this.groupService=s,this.router=a,this.store=c,this.groups$=this.store.select(h.pY),this.people$=this.store.select(h.gU),this.conversations$=this.store.select(h.nX),this.userID$=this.store.select(A.cP),this.isSetTimer$=this.store.select(h.mQ)}ngOnInit(){this.groups$.subscribe(o=>{0===o.length&&this.store.dispatch(d.PT())}),this.people$.subscribe(o=>{0===o.length&&this.store.dispatch(d.I$())}),this.conversations$.subscribe(o=>{0===o.length&&this.store.dispatch(d.yV())}),this.combine$=(0,S.a)([this.people$,this.conversations$]).pipe((0,M.U)(([o,i])=>{console.log("people",o),console.log("con",i);const s=[];let a;return 0!=o.length&&o.map(c=>{const $=i.find(H=>c.uid.S===H.companionID);a=$?{conversationId:$.id,uid:c.uid.S,name:c.name.S}:{uid:c.uid.S,name:c.name.S,conversationId:""},s.push(a)}),s})),this.uid=localStorage.getItem("uid"),this.store.dispatch((0,U.an)({id:this.uid}))}updateGroup(){this.timerService.startTimer(),this.timer$=this.timerService.getTimer(),this.store.dispatch((0,y.b$)({timer:1})),this.timer$.subscribe(o=>{this.timer=o,console.log("timer",this.timer)})}openDialog(){const o=new r.vA;o.disableClose=!0,o.autoFocus=!0,o.data={name:""},this.dialog.open(b,o).afterClosed().subscribe(s=>{s&&this.store.dispatch(d.Rp({nameGroup:s,id:this.uid}))})}deleteGroup(o,i){i.stopPropagation(),this.dialog.open(I.z,{disableClose:!0}).afterClosed().subscribe(a=>{a&&this.store.dispatch(d.iE({id:o}))})}selectGroupChat(o){this.router.navigate(["group",o])}selectUserForChat(o,i){o||this.store.dispatch(d.Xw({companion:i})),this.router.navigate(["conversation",o])}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(r.uw),t.Y36(G),t.Y36(L.J),t.Y36(x.F0),t.Y36(O.yh))};static#o=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-main"]],standalone:!0,features:[t.jDz],decls:28,vars:8,consts:[[1,"page"],[1,"group"],[1,"buttons"],["mat-stroked-button","",3,"click"],["class","timer"],["mat-flat-button","","color","primary",3,"click"],["mat-subheader",""],[3,"vertical"],["mat-stroked-button",""],[1,"timer"],[2,"cursor","pointer",3,"click"],["matListItemIcon","",2,"color","blueviolet"],["matListItemTitle",""],["mat-icon-button","","color","primary"],["matListItemLine",""],["mat-icon-button","","color","primary",3,"click"],["matListItemIcon",""],["style","color: blueviolet","fontIcon","chat"],["fontIcon","chat",2,"color","blueviolet"],["style","cursor: pointer"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return s.updateGroup()}),t._uU(4," update"),t.qZA(),t.YNc(5,P,2,1,"div",4),t.ALo(6,"async"),t.TgZ(7,"button",5),t.NdJ("click",function(){return s.openDialog()}),t._uU(8," create"),t.qZA()(),t._UZ(9,"mat-divider"),t.TgZ(10,"mat-list")(11,"div",6),t._uU(12,"Chats"),t.qZA(),t.SjG(13,R,10,7,"mat-list-item",19,t.x6l),t.ALo(15,"async"),t.qZA()(),t._UZ(16,"mat-divider",7),t.TgZ(17,"div",1)(18,"div",2)(19,"button",8),t._uU(20," update"),t.qZA()(),t._UZ(21,"mat-divider"),t.TgZ(22,"mat-list")(23,"div",6),t._uU(24,"People"),t.qZA(),t.SjG(25,z,6,2,"mat-list-item",19,t.x6l),t.ALo(27,"async"),t.qZA()()()),2&i&&(t.xp6(5),t.um2(5,t.lcZ(6,2,s.isSetTimer$)?5:-1),t.xp6(8),t.wJu(t.lcZ(15,4,s.groups$)),t.xp6(3),t.Q6J("vertical",!0),t.xp6(9),t.wJu(t.lcZ(27,6,s.combine$)))},dependencies:[g.ez,g.Ov,g.uU,C.t,C.d,Z.Ps,Z.Hw,m.ie,m.i$,m.Tg,m.Yt,m.gs,m.WW,m.sL,u.ot,u.lW,u.RK,r.Is,x.Bz],styles:[".page[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.group[_ngcontent-%COMP%]{width:30%}.buttons[_ngcontent-%COMP%]{padding:15px}mat-list-item[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}mat-list-item[_ngcontent-%COMP%]:hover{box-shadow:5px 5px 5px #bb75cec6,-5px -5px 5px #bb75cec6;transition:all .2s ease}.timer[_ngcontent-%COMP%]{width:50px;height:20px}"]})}return e})()}}]);